<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css" integrity="sha384-SI27wrMjH3ZZ89r4o+fGIJtnzkAnFs3E4qz9DIYioCQ5l9Rd/7UAa8DHcaL8jkWt" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/styles.css">
    <title>interactions magazine | Submission</title>
</head>

<body>
    <main>
        <div class="container">

            <div class="row justify-content-center align-items-center" id="page-title">
                <div class="col-12 col-md-3 my-md-5 mt-5 order-md-5">
                    <a href="https://interactions.acm.org">
                        <img class="float-right" src="https://interactions.acm.org/images/logo.gif" alt="interactions magazine logo" width="160px">
                    </a>
                </div>
                <div class="col-12 col-md-7">
                    <h1 class="font-weight-bold my-5">interactions Magazine</h1>
                </div>
            </div>

            <div class="row justify-content-center" id="sub-title">
                <div class="col-12 col-md-10">
                    <h2 class="font-weight-bold mb-3">Submission</h2>
                </div>
            </div>

            <div class="row justify-content-center" id="submission-details">
                <div class="col-12 col-md-10">
                    <div id="app-sub">

                        <div v-for="item in items">
                            <div id="submission">

                                <div v-if="item['fields']['Status'].includes('Ready')" class="row justify-content-center align-items-center my-5">
                                    <div class="col-12 col-md-8 alert alert-success" role="alert">
                                        <h4 class="alert-heading">Ready for ACM</h4>
                                        <p>The editorial team have passed your submission on to the ACM so they can prepare it for publication. The ACM may contact you for further details.</p>
                                        <hr>
                                        <p class="mb-0">Please don't change any of the details below unless we've asked you to.</p>
                                    </div>
                                </div>

                                <div v-if="item['fields']['Status'].includes('In process')" class="row justify-content-center align-items-center my-5">
                                    <div class="col-12 col-md-8 alert alert-warning" role="alert">
                                        <h4 class="alert-heading">In process</h4>
                                        <p>The editorial team are looking through your submission and will be in touch about its appropriateness for the magazine and/or what changes they'd recommend.</p>
                                        <hr>
                                        <p class="mb-0">Please update the details below being sure to complete the required fields.</p>
                                    </div>
                                </div>

                                <div v-if="item['fields']['Status'].includes('Pending')" class="row justify-content-center align-items-center my-5">
                                    <div class="col-12 col-md-8 alert alert-danger" role="alert">
                                        <h4 class="alert-heading">Pending</h4>
                                        <p>Your submission will be assigned to one of the Editorial Team's members. We'll be in touch soon to update you on the status of your submission.</p>
                                    </div>
                                </div>

                                <div v-if="item['fields']['Status'].includes('In process') || item['fields']['Status'].includes('Ready')" class="row justify-content-center align-items-center my-5 ml-3" id="key">
                                    <h3 class="hide-element">Color Key</h3>
                                    <div class="col-12 col-md-8">
                                        <p><span class="badge badge-danger" aria-label="Red tag">Red</span> We need this information to finalise your submission.</p>
                                        <p><span class="badge badge-warning" aria-label="Orange tag">Orange</span> This information is optional.</p>
                                        <p><span class="badge badge-success" aria-label="Green tag">Green</span> We have the information we need.</p>
                                    </div>
                                </div>

                                <div class="px-2">
                                    <h3 class="font-weight-bold">{{ item['fields']['Type'] }} submission details</h3>
                                </div>

                                <table class="table table-bordered table-hover">
                                    <tbody>

                                        <tr>
                                            <th class="align-middle" scope="row">Title</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Title of text']">
                                                    <p class="font-weight-bold my-2">{{ item['fields']['Title of text'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Title of text']" v-on:click="fieldName = 'Title of text'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#submissionModal" data-field="Title of text" data-source="Submission" data-placeholder="Title..."
                                                        aria-label="Green tag"><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Title of text'" type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#submissionModal" data-field="Title of text" data-source="Submission" data-placeholder="Title..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Contact Author</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Primary Contact']">
                                                    <p class="lbr my-2"><a v-bind:href="'author?aut=' + item['fields']['Contact Author']" target="_blank">{{ item['fields']['Primary Contact'] }}</a></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Coauthors</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Coauthors']" id="coauthors">
                                                    <!-- Insert coauthors -->
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>If there are co-authors for this submission please submit their details using this <a href="http://j.mp/ix-mag-author-form" target="_blank">form</a>, and <a v-bind:href="'mailto:eic@interactions.acm.org?Subject=[interactions] ' + item['fields']['Type'] + ' - ' + item['fields']['Primary Contact']" target="_top">email us</a> their names so we can add them to your submission.</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Author Order</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Author Order']">
                                                    <p class="lbr my-2">{{ item['fields']['Author Order'] }}</p>
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>If there is more than one author for this submission, please list all names in the order you want them to appear when published.</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Author Order']" v-on:click="fieldName = 'Author Order'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#submissionModal" data-field="Author Order" data-source="Submission" data-placeholder="Author Order..."
                                                        aria-label="Green tag"><span>update...<span></button>
                                                    <button v-else-if="item['fields']['Coauthors'] && item['fields']['Author Order'] == null" v-on:click="fieldName = 'Author Order'" type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#submissionModal" data-field="Author Order"
                                                        data-source="Submission" data-placeholder="Author Order..."><span>add...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Author Order'" type="button" class="btn btn-sm btn-warning" data-toggle="modal" data-target="#submissionModal" data-field="Author Order" data-source="Submission" data-placeholder="Author Order..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Draft(s)</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Original submission']">
                                                    <p v-if="item['fields']['Original submission']['0']['thumbnails']" class="lbr my-2">
                                                        <a v-bind:href="item['fields']['Original submission']['0']['url']"><img v-bind:src="item['fields']['Original submission']['0']['thumbnails']['small']['url']" alt="Thumbnail. Click to download file"></a>
                                                    </p>
                                                    <p v-else class="lbr my-2">
                                                        <a v-bind:href="item['fields']['Original submission']['0']['url']">{{ item['fields']['Original submission']['0']['filename'] }}</a>
                                                    </p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">

                                                    <button v-on:click="upload('Original submission')" class="btn btn-sm btn-success">Update...</button>
                                                    <!-- <button v-if="item['fields']['Original submission']" v-on:click="fieldName = 'Original submission'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#attachmentModal" aria-label="Green tag"><span>update...</span></button> -->
                                                </div>
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Status'].includes('In process') || item['fields']['Status'].includes('Ready')">
                                            <th class="align-middle" width="25%" scope="row">Final Text</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div class="d-flex flex-row" v-if="item['fields']['Final text']">
                                                    <div class="p-2 align-items-center" v-for="file in item['fields']['Final text']">
                                                        <span v-if="file['thumbnails']"><a v-bind:href="file['url']" data-toggle="tooltip" v-bind:title="file['filename']"><img v-bind:src="file['thumbnails']['small']['url']" class="border border-primary rounded" alt="Image thumbnail. Click to download file" height='50'></a></span>
                                                        <span v-else><a v-bind:href="file['url']" data-toggle="tooltip" v-bind:title="file['filename']"><i class="material-icons md-48 text-muted">insert_drive_file</i></a></span>
                                                    </div>
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>If you have a final version of your content, please <a v-bind:href="'mailto:eic@interactions.acm.org?Subject=[interactions] ' + item['fields']['Type'] + ' - ' + item['fields']['Primary Contact']" target="_top">email</a> it to us.</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-on:click="upload('Final text')" id="upload_widget" class="btn btn-sm btn-success" aria-label="Green tag">Update...</button>
                                                    <button v-else v-on:click="upload('Final text')" id="upload_widget" class="btn btn-sm btn-danger">add...</button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Sub Editor']">
                                            <th class="align-middle" width="25%" scope="row">Sub Editor</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div id="subeditor">
                                                    <!-- Insert sub editors -->
                                                </div>
                                            </td class="align-middle">
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Content Type</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Type']">
                                                    <p class="lbr my-2">{{ item['fields']['Type'] }}</p>
                                                    <!-- <new-final v-bind:title="item['fields']['Content Type']"></new-final> -->
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Target Issue</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Target Issue'] == 'Pipeline'">
                                                    <p class="text-muted my-2"><em>To be decided</em></p>
                                                </div>
                                                <div v-else>
                                                    <p class="my-2">{{ item['fields']['Target Issue'] }} {{ item['fields']['Target Year'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Type']=='Feature' || item['fields']['Type']=='Debate' || item['fields']['Type']=='Forum'">
                                            <th class="align-middle" width="25%" scope="row">Insights</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Insights']">
                                                    <p class="lbr my-2">{{ item['fields']['Insights'] }}</p>
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>2 or 3 bullet points that summarize the article’s key ideas/takeaways. 50 words max total..</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Insights']" v-on:click="fieldName = 'Insights'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#submissionModal" aria-label="Green tag"><span>update...</span></button>
                                                    <button v-else type="button" v-on:click="fieldName = 'Insights'" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#submissionModal"><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <!-- GRAPHICS -->
                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Graphics</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Graphics']">
                                                    <div v-for="graphic in graphics">
                                                        <span v-if="graphic['thumbnails']"><a v-bind:href="graphic['url']" data-toggle="tooltip" v-bind:title="graphic['filename']"><img v-bind:src="graphic['thumbnails']['small']['url']" class="mr-2 my-2 rounded" alt="Image thumbnail. Click to download file" height='50'></a></span>
                                                        <span v-else><p class="my-3"><a v-bind:href="graphic['url']">{{ graphic['filename'] }}</a></p></span>
                                                    </div>
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>If you have images or graphics please <a v-bind:href="'mailto:eic@interactions.acm.org?Subject=[interactions] ' + item['fields']['Type'] + ' - ' + item['fields']['Primary Contact']" target="_top">email</a> them to us (at 300 dpi minimum) so we can add them to your submission.</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Graphics']" v-on:click="fieldName = 'Graphics'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#attachmentModal" aria-label="Green tag"><span>update...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Graphics']">
                                            <th class="align-middle" width="25%" scope="row">Image Caption(s)</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Image Captions']">
                                                    <p class="lbr my-2">{{ item['fields']['Image Captions'] }}</p>
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>Provide a caption for each image, clearly indicating which image the caption corresponds to.</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Image Captions']" v-on:click="fieldName = 'Image Captions'" aria-label="Green tag" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#submissionModal" data-field="Image Captions" data-source="Submission"
                                                        data-placeholder="Image captions...">
                                                        <span>update...</span>
                                                    </button>
                                                    <button v-else v-on:click="fieldName = 'Image Captions'" type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#submissionModal" data-field="Image Captions" data-source="Submission" data-placeholder="Image captions...">
                                                        <span>add...</span>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Graphics']">
                                            <th class="align-middle" width="25%" scope="row">Image alt-text</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Image alt-text']">
                                                    <p class="lbr my-2">{{ item['fields']['Image alt-text'] }}</p>
                                                </div>
                                                <div v-else>
                                                    <p class="lbr text-muted my-2"><em>Provide <a href="https://www.rnib.org.uk/accessibility-guidelines-alt-text-what-you-need-know" target="_blank">alt-text</a> for each image, clearly indicating which image the alt-text corresponds to...</em></p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Image alt-text']" v-on:click="fieldName = 'Image alt-text'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#submissionModal" data-field="Image alt-text" data-source="Submission" data-placeholder="Image alt-text..."
                                                        aria-label="Green tag"><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Image alt-text'" type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#submissionModal" data-field="Image alt-text" data-source="Submission" data-placeholder="Image alt-text..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Responsibility']">
                                            <th class="align-middle" width="25%" scope="row">Responsbility</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div>
                                                    <p class="lbr my-2"><span v-if="item['fields']['Responsibility']">Submission under responsibility of {{ item['fields']['responsibility-string'] }}</span>
                                                    </p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Attachment Modal -->
                        <div class="modal fade" id="attachmentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">Add files</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    </div>

                                    <div class="modal-body">

                                        <!-- <div class="input-group px-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" id="inputGroupFileAddon01">Upload</span>
                                            </div>
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" id="inputGroupFile01" aria-describedby="inputGroupFileAddon01">
                                                <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                                            </div>
                                        </div> -->
                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">ok</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Submission Modal -->
                        <div class="modal fade" id="submissionModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" id="modalLabel">Update</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    </div>

                                    <div class="modal-body">
                                        <form id="updateForm" action="" method="get">

                                            <div v-if="fieldName == 'Insights' || fieldName == 'Author Order' || fieldName == 'Image Captions' || fieldName == 'Image alt-text'" class="form-group" id="updateFormGroup">
                                                <textarea type="text" name="updateInput" value="" class="form-control" id="updateText" rows="6" placeholder=""></textarea>
                                            </div>

                                            <div v-else class="form-group" id="updateFormGroup">
                                                <input type="text" name="updateInput" value="" class="form-control" id="updateInput" placeholder="">
                                            </div>

                                            <div class="form-group mt-3 text-right">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                <button type="button" class="btn btn-primary" Name="updateButton" value="Click" onClick="submitForm(this.form)" data-dismiss="modal">Update</button>
                                            </div>

                                        </form>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="row justify-content-center" id="author-title">
                <div class="col-12 col-md-10">
                    <h3 class="font-weight-bold mt-5 px-2">Contact author details</h3>
                </div>
            </div>

            <div class="row justify-content-center my-3" id="author-details">
                <div class="col-12 col-md-10">
                    <div id="app-auth">
                        <div v-for="item in items">
                            <div v-if="item['fields']['Name']" id="author">
                                <table class="table table-bordered table-hover">
                                    <tbody>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Contact Author</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Name']">
                                                    <p class="lbr font-weight-bold my-2">{{ item['fields']['Name'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Photo']">
                                            <th class="align-middle" width="25%" scope="row">Photo</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div>

                                                    <button type="button" class="btn btn-sm btn-primary" data-toggle="modal" data-target=".photo-modal-sm">View photo</button>

                                                    <div class="modal fade photo-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog modal-dialog-centered modal-sm" role="document">
                                                            <div class="modal-content my-2">

                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="ModalTitle">{{ item['fields']['Name'] }}</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                </div>
                                                                <p class="text-center mt-3">
                                                                    <a v-bind:href="item['fields']['Photo']['0']['url']">
                                                                        <img v-bind:src="item['fields']['Photo'][0]['thumbnails']['large']['url']" class="rounded" alt="Thumbnail. Click to download file" width='250' height='250'>
                                                                    </a>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Group</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div>
                                                    <p class="lbr my-2" v-if="item['fields']['Group']">{{ item['fields']['Group'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Group']" v-on:click="fieldName = 'Group'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#updateModal" data-field="Group" data-source="Author" data-placeholder="Group or lab name..." aria-label="Green tag"><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Group'" type="button" class="btn btn-sm btn-warning" data-toggle="modal" data-target="#updateModal" data-field="Group" data-source="Author" data-placeholder="Group or lab name..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Department</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div>
                                                    <p class="lbr my-2" v-if="item['fields']['Department']">{{ item['fields']['Department'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Department']" v-on:click="fieldName = 'Department'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#updateModal" data-field="Department" data-source="Author" data-placeholder="Department name..."><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Department'" type="button" class="btn btn-sm btn-warning" data-toggle="modal" data-target="#updateModal" data-field="Department" data-source="Author" data-placeholder="Department name..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Organisation</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div>
                                                    <p class="lbr my-2" v-if="item['fields']['Organisation']">{{ item['fields']['Organisation'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Organisation']" v-on:click="fieldName = 'Organisation'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#updateModal" data-field="Organisation" data-source="Author" data-placeholder="Organisation name..."><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Organisation'" type="button" class="btn btn-sm btn-warning" data-toggle="modal" data-target="#updateModal" data-field="Organisation" data-source="Author" data-placeholder="Organisation name..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Twitter</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Twitter']">
                                                    <p class="lbr my-2">{{ item['fields']['Twitter'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Twitter']" v-on:click="fieldName = 'Twitter'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#updateModal" data-field="Twitter" data-source="Author" data-placeholder="Twitter handle..."><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Twitter'" type="button" class="btn btn-sm btn-warning" data-toggle="modal" data-target="#updateModal" data-field="Twitter" data-source="Author" data-placeholder="Twitter handle..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr v-if="item['fields']['Type']=='Features' || item['fields']['Type']=='Forums' || item['fields']['Type']=='Columns' || item['fields']['Type']=='Blog' || item['fields']['Type']=='Blog@UX'">
                                            <th class="align-middle" width="25%" scope="row">Bio</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div>
                                                    <p class="lbr my-2" v-if="item['fields']['Short Bio']">{{ item['fields']['Short Bio'] }}</p>
                                                    <p class="lbr my-2" v-else>50 words maximum.</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Short Bio']" v-on:click="fieldName = 'Short Bio'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#updateModal" data-field="Short Bio" data-source="Author" data-placeholder="Short Bio..."><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Short Bio'" type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#updateModal" data-field="Short Bio" data-source="Author" data-placeholder="Short Bio..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="align-middle" width="25%" scope="row">Postal Address</th>
                                            <td class="align-middle border-right-0" width="65%">
                                                <div v-if="item['fields']['Postal Address']">
                                                    <p class="lbr my-2">{{ item['fields']['Postal Address'] }}</p>
                                                </div>
                                            </td>
                                            <td class="align-middle border-left-0" width="10%">
                                                <div class="text-right">
                                                    <button v-if="item['fields']['Postal Address']" v-on:click="fieldName = 'Postal Address'; airtableTable = 'Author'" type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#updateModal" data-field="Postal Address" data-source="Author"
                                                        data-placeholder="Postal Address..."><span>update...</span></button>
                                                    <button v-else v-on:click="fieldName = 'Postal Address'; airtableTable = 'Author'" type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#updateModal" data-field="Postal Address" data-source="Author" data-placeholder="Postal Address..."><span>add...</span></button>
                                                </div>
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                            <div v-else class="my-5 text-center">
                                <p>The author details didn't load properly. Try <a href="javascript:window.location.reload();">refreshing the page.</a></p>
                            </div>
                        </div>

                        <!-- Author Modal -->
                        <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" id="modalLabel">Update</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    </div>

                                    <div class="modal-body">
                                        <form id="updateForm" action="" method="get">

                                            <div v-if="fieldName == 'Twitter'" class="input-group" id="updateFormGroup">
                                                <!-- insert @ prepend -->
                                                <div class='input-group-prepend' id='twitterAt'>
                                                    <div class='input-group-text'>@</div>
                                                </div>
                                                <input type="text" name="updateInput" value="" class="form-control" id="updateTwitter" placeholder="">
                                            </div>

                                            <div v-else-if="fieldName == 'Short Bio' || fieldName == 'Postal Address' || fieldName == 'Insights' || fieldName == 'Author Order' || fieldName == 'Image Captions' || fieldName == 'Image alt-text'" class="form-group" id="updateFormGroup">
                                                <textarea type="text" name="updateInput" value="" class="form-control" id="updateText" rows="6" placeholder=""></textarea>
                                            </div>

                                            <div v-else class="form-group" id="updateFormGroup">
                                                <input type="text" name="updateInput" value="" class="form-control" id="updateInput" placeholder="">
                                            </div>

                                            <div class="form-group mt-3 text-right">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                <button type="button" class="btn btn-primary" Name="updateButton" value="Click" onClick="submitForm(this.form)" data-dismiss="modal">Update</button>
                                            </div>

                                        </form>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="row justify-content-center my-3" id="FAQs">
                <div class="col-12 col-md-9">
                    <h2 class="font-weight-bold mt-5">Frequently Asked Questions</h2>

                    <p class="mb-4">Read the following for information about submissions to <em>interactions</em>, and the process we follow to edit and then publish content.</p>

                    <h3>Content</h3>
                    <p class="mb-4"><em>What types of content can I submit to interactions?</em><br/>For the types of content in the magazine see <a href="https://interactions.acm.org/submissions">here</a>.</p class="mb-4">

                    <p class="mb-1"><em>How long should my contribution be?</em><br/>The maximum lengths for the different content types are:</p>
                    <ul class="mb-4">
                        <li>Abracadabra columns: 1200 words</li>
                        <li>Blogs: 800-1200 words</li>
                        <li>Community Square articles: 550 words</li>
                        <li>Cover story: 3500 words</li>
                        <li>Demo Hour: 100 words</li>
                        <li>Feature articles: 2750 words</li>
                        <li>How Was It Made? pieces: 500 words</li>
                        <li>What Are Your Reading pieces: 500 words</li>
                    </ul>

                    <p class="mb-4"><em>What file type should I use to submit content?</em><br/>We need to have content in an editable format such as Microsoft Word doc/docx, RTFs, or plain text files.</p>

                    <p class="mb-1"><em>How many references can I include?</em></p>
                    <ul class="mb-4">
                        <li>Cover stories: 9 max.</li>
                        <li>Abracadabra and Features: 6 max</li>
                    </ul>

                    <p class="mb-1"><em>How many figures or images can I include?</em></p>
                    <ul class="mb-4">
                        <li>Cover stories : approx 3-5.</li>
                        <li>Abracadabra and Features: 1-3</li>
                    </ul>

                    <p><em>What is the expected image quality?</em><br/> Ideally figures should be in a vector graphic format (e.g. Adobe Illustrator, eps, etc.). For bitmap figures or photographs we aim for 300 dpi.</p>
                    <br/>

                    <h3>Process</h3>
                    <p class="mb-4"><em>Is the work reviewed?</em><br/><em>interactions</em> is a magazine and thus content does not undergo a formal or blind review process. However, the sub-editors and/or editors in chief do carefully view incoming content to assess
                        it's suitability. Content may be accepted as is or authors may be asked to make amendments to ensure it speaks to the magazine's general readership and is in line with the goals of the publication. Submissions may be deemed outside
                        the scope of the magazine in which case the editors in chief will inform the authors.</p>

                    <p class="mb-4"><em>When will my contribution be published?</em><br/>Content is published on a rolling basis and also where possible organised around particular issues or topics. Once a submission is finalised, our aim is to have the work in the magazine
                        within one of the next three issues.</p>

                    <h3>Contact</h3>
                    <p class="mb-4"><em>Who should I contact about any administrative or procedural matters?</em><br/>If you're seeking further clarity about the process we follow in accepting and publishing work, or where your submission is in the process please address
                        communications to the <em>Assistant to the Editors in Chief</em>, using <a href="mailto:eic@interactions.acm.org?Subject=[interactions] Query to Assistant" target="_top">eic@interactions.acm.org</a>.</p>

                    <p class="mb-5"><em>Who should I contact about any substantive questions about content?</em><br/>If you have substantive questions about work you have submitted or about work you plan to submit, such as questions about the kind of content to submit
                        or the style of writing, please address communications to the <em>Editors in Chief</em>, using <a href="mailto:eic@interactions.acm.org?Subject=[interactions] Query to EIC" target="_top">eic@interactions.acm.org</a>.</p>
                </div>
            </div>

            <div id="reload-page">
                <div class="d-flex justify-content-center">
                    <div class="mt-5 text-center text-light">
                        <p><strong>Loading...</strong></p>
                    </div>
                    <div class="spinner-grow text-light mt-5" style="width: 3rem; height: 3rem;" role="status">
                    </div>
                </div>
            </div>

        </div>
    </main>
    <footer>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-12 col-md-10 my-5">
                    <a href="https://interactions.acm.org">
                        <img src="https://interactions.acm.org/images/logo.gif" alt="interactions magazine logo" width="160px">
                    </a>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/js/bootstrap.min.js" integrity="sha384-3qaqj0lc6sV/qpzrc1N5DC6i1VRn/HyX4qdPaiEFbn54VjQBEU341pvjz7Dv3n6P" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <script type="text/javascript" src="https://widget.cloudinary.com/v2.0/global/all.js"></script>
    <script type="text/javascript">
        var app_id = "appgcGlPwTaZaBImL";
        var app_key = "key8l5YZtQ9FyUoxF";
        var submission_rec;
        var author_rec;
        var coauthor_recs = [];
        var subeditor_rec;
        var coauthorURLParams;
        var subeditorURLParams;
        var source;
        cloudinary.setCloudName("ix-acm");
        var cloudinaryURL;
        var airtable_write_endpoint;

        // TEST

        Vue.component('new-final', {
            props: ['title'],
            data: function() {
                return {
                    count: 0
                }
            },
            template: '<button v-on:click="fieldName=\'Final Text\'">Update</button>'
        })

        // TEST

        var app_sub = new Vue({
            el: '#app-sub',
            data: {
                items: [],
                graphics: [],
                fieldName: ''
            },
            mounted: function() {
                this.loadItems();
            },
            methods: {
                loadItems: function() {
                    let url = new URL(window.location.href);
                    submission_rec = url.searchParams.get("id");
                    author_rec = url.searchParams.get("aut");
                    let submission_url = "https://api.airtable.com/v0/" + app_id + "/Content?filterByFormula=FIND(%22" + submission_rec + "%22%2CID)&maxRecords=1";
                    let self = this;
                    axios.get(
                        submission_url, {
                            headers: {
                                Authorization: "Bearer " + app_key
                            }
                        }
                    ).then(function(response) {
                        self.items = response.data.records;
                        if (author_rec === null) {
                            author_rec = self.items[0].fields['Contact Author'];
                        }
                        if (self.items[0].fields['Coauthors']) {
                            coauthor_recs = self.items[0].fields['Coauthors'];
                            coauthorURLParams = encodeURI('filterByFormula=OR(RECORD_ID()="' + coauthor_recs.join('",RECORD_ID()="') + '")&maxRecords=' + coauthor_recs.length);
                        } else {
                            coauthorURLParams = "maxRecords=0";
                        }
                        if (self.items[0].fields['Sub Editor']) {
                            subeditor_rec = self.items[0].fields['Sub Editor'];
                            subeditorURLParams = encodeURI('filterByFormula=FIND("' + subeditor_rec + '",ID)&maxRecords=1');
                        } else {
                            subeditorURLParams = "maxRecords=0";
                        }
                        if (self.items[0].fields['Graphics']) {
                            self.graphics = self.items[0].fields['Graphics'];
                        }
                        var widget = cloudinary.createUploadWidget({
                                uploadPreset: "asbafw8w",
                                //public_id: fileName,
                                //overwrite: true,
                                sources: ["local"],
                                showAdvancedOptions: false,
                                cropping: false,
                                multiple: false,
                                defaultSource: "local",
                                styles: {
                                    palette: {
                                        window: "#ffffff",
                                        sourceBg: "#f4f4f5",
                                        windowBorder: "#90a0b3",
                                        tabIcon: "#000000",
                                        inactiveTabIcon: "#555a5f",
                                        menuIcons: "#555a5f",
                                        link: "#0433ff",
                                        action: "#339933",
                                        inProgress: "#0433ff",
                                        complete: "#339933",
                                        error: "#cc0000",
                                        textDark: "#000000",
                                        textLight: "#fcfffd"
                                    },
                                    fonts: {
                                        default: null,
                                        "sans-serif": {
                                            url: null,
                                            active: true
                                        }
                                    }
                                }
                            },
                            (error, result) => {
                                if (!error && result.event == "success") {
                                    if (self.items[0].fields['' + fieldName + '']) {
                                        var l = eval(self.items[0].fields['' + fieldName + ''].length);
                                    } else {
                                        var l = 0;
                                    }
                                    cloudinaryURL = result.info.url;
                                    airtable_write_endpoint = "https://api.airtable.com/v0/" + app_id + "/Content/" + submission_rec + "/?api_key=" + app_key;
                                    console.log(airtable_write_endpoint);
                                    let updateFieldValue = cloudinaryURL;
                                    console.log(updateFieldValue);
                                    let updateFieldData = '{ "fields": { "' + self.fieldName + '": [ { "url": "' + updateFieldValue + '"}, { "filename": "' + fileName + '"} ] }';
                                    updateFieldData = updateFieldData.replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/\t/g, "\\t");
                                    console.log(updateFieldData);
                                    updateFieldData = JSON.parse(updateFieldData);
                                    //axios.patch(airtable_write_endpoint, updateFieldData);



                                }
                            });

                        setTimeout(() => {

                            var el = document.getElementById('upload_widget');
                            el.addEventListener("click", function() {
                                widget.open();
                            }, false);
                            console.log("Ready");
                        }, 1000);
                    }).catch(function(error) {
                        console.log(error);
                    })
                },
                upload: function(field) {
                    //Check if there are exisiting attachments and calculate version number
                    this.fieldName = field;
                    if (this.items[0].fields['' + field + '']) {
                        var v = 1 + eval(this.items[0].fields['' + field + ''].length);
                    } else {
                        var v = 1;
                    }
                    fileName = this.items[0].fields['Primary Contact'] + "-" + this.items[0].fields['Title of text'] + "-v" + v;
                    fileName = fileName.replace(/ /g, "_");
                    console.log('The filename is: ' + fileName);
                }
            }
        });

        var app_auth = new Vue({
            el: '#app-auth',
            data: {
                items: [],
                fieldName: '',
                airtableTable: ''
            },
            mounted: function() {
                this.loadItems();
            },
            methods: {
                loadItems: function() {
                    let self = this;

                    setTimeout(() => {
                        let h = document.getElementById("coauthors");
                        let k = document.getElementById("subeditor");
                        let author_url = "https://api.airtable.com/v0/" + app_id + "/Editors%20%26%20Authors?filterByFormula=FIND(%22" + author_rec + "%22%2CID)&maxRecords=1";
                        let coauthor_url = "https://api.airtable.com/v0/" + app_id + "/Editors%20%26%20Authors?" + coauthorURLParams;
                        let subauthor_url = "https://api.airtable.com/v0/" + app_id + "/Editors%20%26%20Authors?" + subeditorURLParams;

                        axios.all([
                                axios.get(author_url, {
                                    headers: {
                                        Authorization: "Bearer " + app_key
                                    }
                                }),
                                axios.get(coauthor_url, {
                                    headers: {
                                        Authorization: "Bearer " + app_key
                                    }
                                }),
                                axios.get(subauthor_url, {
                                    headers: {
                                        Authorization: "Bearer " + app_key
                                    }
                                })
                            ])
                            .then(response => {
                                self.items = response[0].data.records;
                                let obj = response[1].data.records;
                                let objSub = response[2].data.records;
                                if (obj[0]) {
                                    for (i in obj) {
                                        h.insertAdjacentHTML("beforeend", '<p class="lbr my-2"><a href="author?aut=' + obj[i].fields.ID + '" target="_blank">' + obj[i].fields.Name + '</a></p>')
                                    }
                                };
                                if (objSub[0]) {
                                    k.insertAdjacentHTML("beforeend", '<p class="lbr my-2">' + objSub[0].fields.Name + '</p>')
                                }
                            }).catch(function(error) {
                                console.log(error);
                            })
                    }, 1200);

                }
            }
        });

        $('#updateModal').add('#submissionModal').on('show.bs.modal', function(event) {
            var button = $(event.relatedTarget); // Button that triggered the modal
            airtableField = button.data('field'); //.replace(/ /g, "_");
            source = button.data('source');
            var placeholder = button.data('placeholder');
            var modal = $(this);
            //var inputPrepend = "<div class='input-group-prepend' id='twitterAt'><div class='input-group-text'>@</div></div>";

            /* if (airtableField == 'Twitter' && document.getElementById('twitterAt') === null) {
                //document.getElementById('updateFormGroup').insertAdjacentHTML('afterbegin', inputPrepend);
            } */
            modal.find('.modal-title').text(source + ' update');
            modal.find('.form-control').attr('placeholder', placeholder)
        });

        function submitForm(form) {
            //form.updateInput.append("file", 'image');
            //console.log(form.updateInput.file);
            console.log(form.updateInput.value);
            var updateFieldData;
            var updateFieldValue;
            var airtable_write_endpoint;

            if (source == 'Author') {
                airtable_write_endpoint = "https://api.airtable.com/v0/" + app_id + "/Editors%20%26%20Authors/" + author_rec + "/?api_key=" + app_key;
            } else if (source == 'Submission') {
                airtable_write_endpoint = "https://api.airtable.com/v0/" + app_id + "/Content/" + submission_rec + "/?api_key=" + app_key;
            }

            if (airtableField == 'Twitter') {
                updateFieldValue = "@" + form.updateInput.value;
            } else {
                updateFieldValue = form.updateInput.value;
            }

            updateFieldData = '{"fields": { "' + airtableField + '": "' + updateFieldValue + '"} }';
            updateFieldData = updateFieldData.replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/\t/g, "\\t");
            updateFieldData = JSON.parse(updateFieldData);

            axios.patch(airtable_write_endpoint, updateFieldData);
            document.getElementById("reload-page").style.display = "block";
            setTimeout(function() {
                $(window).scrollTop(0);

                location.reload();
            }, 2000);
        }
    </script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
</body>

</html>